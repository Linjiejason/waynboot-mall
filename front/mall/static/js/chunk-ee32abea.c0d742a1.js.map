{"version":3,"sources":["webpack:///./src/views/auth/registry.vue?bbd1","webpack:///./src/views/auth/registry.vue?52f8","webpack:///./src/api/login.js","webpack:///src/views/auth/registry.vue","webpack:///./src/views/auth/registry.vue?029e","webpack:///./src/views/auth/registry.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","$route","meta","title","variables","black","on","onSubmit","validator","checkPhone","required","message","model","value","form","callback","$$v","$set","expression","checkEmail","disabled","$event","stopPropagation","getMailCode","apply","arguments","slot","_v","_s","btnText","staticStyle","loading","staticRenderFns","data","request","url","method","timeout","name","mobile","email","password","confirmPassword","emailCode","emailKey","key","totalCount","computed","mounted","methods","interval","setInterval","clearInterval","type","duration","$toast","fail","reg","test","num","setRegistry","then","onOpened","finally","component"],"mappings":"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","file":"static/js/chunk-ee32abea.c0d742a1.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./registry.vue?vue&type=style&index=0&id=4621484d&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"registration\"},[_c('nav-bar',{attrs:{\"title\":_vm.$route.meta.title}},[_c('van-icon',{attrs:{\"color\":_vm.variables.black,\"size\":\"18\"}})],1),_c('van-form',{staticClass:\"form\",attrs:{\"validate-trigger\":\"onSubmit\",\"show-error\":false},on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"type\":\"text\",\"required\":\"\",\"clearable\":\"\",\"name\":\"手机号码\",\"label\":\"手机号码\",\"placeholder\":\"请输入手机号码\",\"rules\":[\n        {\n          validator: _vm.checkPhone,\n          required: true,\n          message: '请输入正确的邮箱地址!',\n        } ]},model:{value:(_vm.form.mobile),callback:function ($$v) {_vm.$set(_vm.form, \"mobile\", $$v)},expression:\"form.mobile\"}}),_c('van-field',{attrs:{\"type\":\"text\",\"required\":\"\",\"clearable\":\"\",\"name\":\"注册邮箱\",\"label\":\"注册邮箱\",\"placeholder\":\"请输入邮箱地址\",\"rules\":[\n        {\n          validator: _vm.checkEmail,\n          required: true,\n          message: '请输入正确的邮箱地址!',\n        } ]},model:{value:(_vm.form.email),callback:function ($$v) {_vm.$set(_vm.form, \"email\", $$v)},expression:\"form.email\"}}),_c('van-field',{attrs:{\"type\":\"password\",\"required\":\"\",\"clearable\":\"\",\"name\":\"设置密码\",\"label\":\"设置密码\",\"placeholder\":\"请设置密码\",\"rules\":[{ required: true, message: '请设置密码!' }]},model:{value:(_vm.form.password),callback:function ($$v) {_vm.$set(_vm.form, \"password\", $$v)},expression:\"form.password\"}}),_c('van-field',{attrs:{\"type\":\"password\",\"required\":\"\",\"clearable\":\"\",\"name\":\"确认密码\",\"label\":\"确认密码\",\"placeholder\":\"请再次输入密码确认\",\"rules\":[{ required: true, message: '请再次输入密码确认!' }]},model:{value:(_vm.form.confirmPassword),callback:function ($$v) {_vm.$set(_vm.form, \"confirmPassword\", $$v)},expression:\"form.confirmPassword\"}}),_c('van-field',{attrs:{\"type\":\"text\",\"required\":\"\",\"center\":\"\",\"clearable\":\"\",\"name\":\"邮箱验证码\",\"label\":\"邮箱验证码\",\"placeholder\":\"请输入验证码\",\"rules\":[{ required: true, message: '请输入正确的邮箱验证码！' }]},model:{value:(_vm.form.emailCode),callback:function ($$v) {_vm.$set(_vm.form, \"emailCode\", $$v)},expression:\"form.emailCode\"}},[_c('van-button',{attrs:{\"slot\":\"button\",\"size\":\"small\",\"plain\":\"\",\"type\":\"info\",\"native-type\":\"button\",\"disabled\":_vm.disabled},on:{\"click\":function($event){$event.stopPropagation();return _vm.getMailCode.apply(null, arguments)}},slot:\"button\"},[_vm._v(_vm._s(_vm.btnText))])],1),_c('div',{staticStyle:{\"margin\":\"36px\"}},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"loading\":_vm.loading,\"type\":\"info\",\"loading-text\":\"登录中...\",\"native-type\":\"submit\"}},[_vm._v(\"注册\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import request from '@/utils/request'\r\n\r\nexport function getCaptcha() {\r\n  return request({\r\n    url: '/captcha',\r\n    method: 'get'\r\n  })\r\n}\r\n\r\nexport function getMailCode(data) {\r\n  return request({\r\n    url: '/sendEmailCode',\r\n    method: 'post',\r\n    data,\r\n    timeout: 20000\r\n  })\r\n}\r\n","\r\n<template>\r\n  <div class=\"registration\">\r\n    <nav-bar :title=\"$route.meta.title\">\r\n      <van-icon :color=\"variables.black\" size=\"18\" />\r\n    </nav-bar>\r\n\r\n    <van-form\r\n      class=\"form\"\r\n      validate-trigger=\"onSubmit\"\r\n      :show-error=\"false\"\r\n      @submit=\"onSubmit\"\r\n    >\r\n      <van-field\r\n        v-model=\"form.mobile\"\r\n        type=\"text\"\r\n        required\r\n        clearable\r\n        name=\"手机号码\"\r\n        label=\"手机号码\"\r\n        placeholder=\"请输入手机号码\"\r\n        :rules=\"[\r\n          {\r\n            validator: checkPhone,\r\n            required: true,\r\n            message: '请输入正确的邮箱地址!',\r\n          },\r\n        ]\"\r\n      />\r\n\r\n      <van-field\r\n        v-model=\"form.email\"\r\n        type=\"text\"\r\n        required\r\n        clearable\r\n        name=\"注册邮箱\"\r\n        label=\"注册邮箱\"\r\n        placeholder=\"请输入邮箱地址\"\r\n        :rules=\"[\r\n          {\r\n            validator: checkEmail,\r\n            required: true,\r\n            message: '请输入正确的邮箱地址!',\r\n          },\r\n        ]\"\r\n      />\r\n\r\n      <van-field\r\n        v-model=\"form.password\"\r\n        type=\"password\"\r\n        required\r\n        clearable\r\n        name=\"设置密码\"\r\n        label=\"设置密码\"\r\n        placeholder=\"请设置密码\"\r\n        :rules=\"[{ required: true, message: '请设置密码!' }]\"\r\n      />\r\n\r\n      <van-field\r\n        v-model=\"form.confirmPassword\"\r\n        type=\"password\"\r\n        required\r\n        clearable\r\n        name=\"确认密码\"\r\n        label=\"确认密码\"\r\n        placeholder=\"请再次输入密码确认\"\r\n        :rules=\"[{ required: true, message: '请再次输入密码确认!' }]\"\r\n      />\r\n\r\n      <van-field\r\n        v-model=\"form.emailCode\"\r\n        type=\"text\"\r\n        required\r\n        center\r\n        clearable\r\n        name=\"邮箱验证码\"\r\n        label=\"邮箱验证码\"\r\n        placeholder=\"请输入验证码\"\r\n        :rules=\"[{ required: true, message: '请输入正确的邮箱验证码！' }]\"\r\n      >\r\n        <van-button\r\n          slot=\"button\"\r\n          size=\"small\"\r\n          plain\r\n          type=\"info\"\r\n          native-type=\"button\"\r\n          :disabled=\"disabled\"\r\n          @click.stop=\"getMailCode\"\r\n        >{{ btnText }}</van-button>\r\n      </van-field>\r\n\r\n      <div style=\"margin: 36px\">\r\n        <van-button\r\n          round\r\n          block\r\n          :loading=\"loading\"\r\n          type=\"info\"\r\n          loading-text=\"登录中...\"\r\n          native-type=\"submit\"\r\n        >注册</van-button>\r\n      </div>\r\n    </van-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport variables from '@/styles/variables.scss'\r\nimport { getMailCode } from '@/api/login'\r\nimport { setRegistry } from '@/api/user'\r\n\r\nexport default {\r\n  name: 'Regist',\r\n  data() {\r\n    return {\r\n      form: {\r\n        mobile: '',\r\n        email: '',\r\n        password: '',\r\n        confirmPassword: '',\r\n        emailCode: '',\r\n        emailKey: '',\r\n        key: ''\r\n      },\r\n      disabled: false,\r\n      totalCount: 0,\r\n      loading: false\r\n    }\r\n  },\r\n  computed: {\r\n    variables() {\r\n      return variables\r\n    },\r\n    btnText() {\r\n      return this.totalCount !== 0 ? `${this.totalCount}秒后获取` : '获取验证码'\r\n    }\r\n\r\n  },\r\n  mounted() {\r\n  },\r\n  methods: {\r\n    // 获取邮箱验证码\r\n    getMailCode() {\r\n      const { email } = this.form\r\n      if (!email || !this.checkEmail(email)) {\r\n        this.$toast.fail('请先输入正确的邮箱地址')\r\n        return\r\n      }\r\n      this.disabled = true\r\n      this.totalCount = 60\r\n      this.interval = setInterval(() => {\r\n        this.totalCount--\r\n        if (this.totalCount === 0) {\r\n          clearInterval(this.interval)\r\n          this.disabled = false\r\n        }\r\n      }, 1000)\r\n      getMailCode({ email }).then((res) => {\r\n        this.form.emailKey = res.map.key\r\n        this.$notify({\r\n          type: 'success',\r\n          message: '邮箱验证码已发送',\r\n          duration: 2000\r\n        })\r\n      })\r\n    },\r\n    // 校检邮箱\r\n    checkEmail(email) {\r\n      const reg = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\r\n      return reg.test(email)\r\n    },\r\n    // 校检手机号\r\n    checkPhone(num) {\r\n      if (num === 123456789) return true\r\n      const reg = /^[1][3,4,5,7,8][0-9]{9}$/\r\n      if (reg.test(num)) {\r\n        return true\r\n      }\r\n      return false\r\n    },\r\n    // 提交\r\n    onSubmit() {\r\n      const { password, confirmPassword } = this.form\r\n      if (password !== confirmPassword) {\r\n        this.$toast.fail('确认密码与设置的不一致')\r\n        return\r\n      }\r\n      this.loading = true\r\n      setRegistry(this.form)\r\n        .then((res) => {\r\n          this.$notify({\r\n            type: 'success',\r\n            message: '注册成功，请登录',\r\n            duration: 2000,\r\n            onOpened: () => {\r\n              this.$router.back()\r\n            }\r\n          })\r\n        })\r\n        .finally(() => {\r\n          this.loading = false\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.form {\r\n  padding: 24px;\r\n}\r\n.regist-code {\r\n  height: 40px;\r\n  img {\r\n    vertical-align: middle;\r\n    position: relative;\r\n    top: -2.467vw;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./registry.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./registry.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./registry.vue?vue&type=template&id=4621484d&scoped=true&\"\nimport script from \"./registry.vue?vue&type=script&lang=js&\"\nexport * from \"./registry.vue?vue&type=script&lang=js&\"\nimport style0 from \"./registry.vue?vue&type=style&index=0&id=4621484d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4621484d\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}